// 表达式求值器 - Environment 组件
// 用于存储变量名到值的映射
// Note: Value type is imported via the main module


public type Environment(mut vars [String, types.Value]Map)

given Environment {
    public new() Self = Environment([String, types.Value]Map.new())

    public get(self, name String) [types.Value]Option = self.vars.get(name)

    public set(self ref, name String, value types.Value) Void = {
        self.vars.insert(name, value);
    }

    public clear(self ref) Void = self.vars.clear()

    public list_vars(self) Void = {
        if self.vars.is_empty() then {
            print_line("No variables defined.")
        } else {
            print_line("Variables:")
            for entry = self.vars then {
                let s = String.zero()
                s.push_string("  ")
                s.push_string(entry.key)
                s.push_string(" = ")
                s.push_string(entry.value.to_string())
                print_line(s)
            }
        }
    }
}

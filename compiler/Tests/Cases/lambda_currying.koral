// Lambda currying test
// EXPECT: 42

let main() Int = {
    // Test 1: Basic curried function (inner lambda needs explicit type)
    let add [Int, [Int, Int]Func]Func = (x Int) -> (y Int) -> x + y
    let add40 = add(40)
    let r1 = add40(2)  // 40 + 2 = 42
    print_line(r1)
    
    // Test 2: Direct curried call
    let r2 = add(20)(22)  // 20 + 22 = 42
    print_line(r2)
    
    // Test 3: Three-level currying
    let add3 [Int, [Int, [Int, Int]Func]Func]Func = (x Int) -> (y Int) -> (z Int) -> x + y + z
    let r3 = add3(10)(20)(12)  // 10 + 20 + 12 = 42
    print_line(r3)
    
    // Test 4: Partial application
    let add10 = add3(10)
    let add10_20 = add10(20)
    let r4 = add10_20(12)  // 10 + 20 + 12 = 42
    print_line(r4)
    
    // Test 5: Curried multiplication
    let mul [Int, [Int, Int]Func]Func = (x Int) -> (y Int) -> x * y
    let times2 = mul(2)
    let r5 = times2(21)  // 2 * 21 = 42
    print_line(r5)
    
    // Test 6: Curried function with explicit types
    let sub [Int, [Int, Int]Func]Func = (x Int) [Int, Int]Func -> (y Int) Int -> x - y
    let r6 = sub(50)(8)  // 50 - 8 = 42
    print_line(r6)
    
    // Test 7: Compose curried functions
    let compose [Int, Int]Func = (x Int) -> add(mul(x)(2))(0)
    let r7 = compose(21)  // (21 * 2) + 0 = 42
    print_line(r7)
    
    r1
}

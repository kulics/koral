// EXPECT-ERROR: diagnostic_type_mismatch_line_2.koral:28:5: error: Type mismatch: expected [UInt8]List, got String

let takes_bytes_2(bytes [UInt8]List) Void = {}

let build_payload_2(rounds UInt) String = {
    let mut i UInt = 0
    let mut current = "seed"

    while i < rounds then {
        // keep mutating in loop so this case differs from nested-if style
        current = "abc"
        i += 1
    }

    yield current
}

// Regression target #2:
// - with comments/empty lines and loop/control flow
// - diagnostic should still point to the concrete function call
let main() Void = {
    let mut rounds UInt = 2
    rounds += 1

    let payload = build_payload_2(rounds)

    // takes_bytes_2 expects [UInt8]List, but we pass String intentionally
    takes_bytes_2(payload)
}

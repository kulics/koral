// Test Error trait + Result type with trait objects
// EXPECT: file not found
// EXPECT: is_error: true
// EXPECT: 42

public let failing_op() [Int]Result = {
    yield [Int]Result.Error(ref "file not found")
}

public let success_op() [Int]Result = {
    yield [Int]Result.Ok(42)
}

let main() Int = {
    // Test Result.Error with string (String implements Error trait)
    let r1 = failing_op()
    when r1 is {
        .Ok(v) then println(v.to_string()),
        .Error(e) then println(e.message()),
    }

    // Test is_error
    println("is_error: " + r1.is_error().to_string())

    // Test Result.Ok
    let r2 = success_op()
    when r2 is {
        .Ok(v) then println(v.to_string()),
        .Error(e) then println(e.message()),
    }

    yield 0
}

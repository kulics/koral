// Test: Method calls on ref types should auto-dereference
// EXPECT: 3
// EXPECT: 42

public type Counter(value Int)

given Counter {
    public count(self) Int = self.value
}

// Function that takes a ref parameter and calls method on it
let get_count(c Counter ref) Int = c.count()

// Function that takes a List ref and uses subscript
let get_first(list [Int]List ref) Int = list[0]

public let main() Void = {
    let counter = Counter(3)
    print_line(get_count(ref counter).to_string())
    
    let mut nums = [Int]List.new()
    nums.push(42)
    nums.push(10)
    nums.push(20)
    print_line(get_first(ref nums).to_string())
}

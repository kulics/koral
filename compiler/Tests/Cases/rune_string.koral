// Test String Rune methods
// EXPECT: All String Rune tests passed!

let main() Int = {
    // Test 1: runes() iterator on ASCII string
    let ascii_str = "Hello"
    let mut iter = ascii_str.runes().iterator()
    let mut count = 0
    while iter.next() is .Some(r) then {
        count = count + 1
    }
    assert(count == 5, "ASCII string should have 5 runes")
    
    // Test 2: push_rune() with ASCII
    let mut s1 = String.zero()
    s1.push_rune(Rune((UInt32)65))  // 'A'
    s1.push_rune(Rune((UInt32)66))  // 'B'
    s1.push_rune(Rune((UInt32)67))  // 'C'
    assert(s1 == "ABC", "push_rune should build 'ABC'")
    assert(s1.count() == 3, "ABC should be 3 bytes")
    
    // Test 3: push_rune() with multi-byte characters
    let mut s2 = String.zero()
    s2.push_rune(Rune((UInt32)233))  // 'Ã©' (2 bytes)
    assert(s2.count() == 2, "Ã© should be 2 bytes")
    
    // Test 4: push_rune() with CJK character
    let mut s3 = String.zero()
    s3.push_rune(Rune((UInt32)20013))  // 'ä¸­' (3 bytes)
    assert(s3.count() == 3, "ä¸­ should be 3 bytes")
    
    // Test 5: push_rune() with emoji
    let mut s4 = String.zero()
    s4.push_rune(Rune((UInt32)128512))  // ðŸ˜€ (4 bytes)
    assert(s4.count() == 4, "ðŸ˜€ should be 4 bytes")
    
    // Test 6: Rune.to_string() consistency with push_rune()
    let rune_a = Rune((UInt32)65)
    let str_from_to_string = rune_a.to_string()
    let mut str_from_push = String.zero()
    str_from_push.push_rune(rune_a)
    assert(str_from_to_string == str_from_push, "to_string and push_rune should produce same result")
    
    // Test 7: byte_count consistency with actual encoding
    let rune_cjk = Rune((UInt32)20013)  // 'ä¸­'
    let str_cjk = rune_cjk.to_string()
    assert(rune_cjk.byte_count() == str_cjk.count(), "byte_count should match actual byte count")
    
    // Test 8: to_runes() returns correct List
    let runes = "ABC".to_runes()
    assert(runes.count() == 3, "to_runes count should be 3")
    assert(runes[0].to_uint32() == (UInt32)65, "to_runes[0] should be 'A'")
    assert(runes[1].to_uint32() == (UInt32)66, "to_runes[1] should be 'B'")
    assert(runes[2].to_uint32() == (UInt32)67, "to_runes[2] should be 'C'")
    
    // Test 9: to_runes() on empty string
    let empty_runes = "".to_runes()
    assert(empty_runes.count() == 0, "to_runes on empty string should be empty")
    
    print_line("All String Rune tests passed!")
    0
}

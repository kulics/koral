// Test range patterns in when expressions

let test_closed_range() Int = {
  let x = 5
  when x is {
    1..10 then 1,
    _ then 0,
  }
}

let test_closed_open_range() Int = {
  let x = 10
  when x is {
    1..<10 then 1,
    _ then 0,
  }
}

let test_open_closed_range() Int = {
  let x = 1
  when x is {
    1<..10 then 1,
    _ then 0,
  }
}

let test_open_range() Int = {
  let x = 5
  when x is {
    1<..<10 then 1,
    _ then 0,
  }
}

let test_from_range() Int = {
  let x = 100
  when x is {
    10... then 1,
    _ then 0,
  }
}

let test_to_range() Int = {
  let x = 5
  when x is {
    ...10 then 1,
    _ then 0,
  }
}

let test_to_open_range() Int = {
  let x = 10
  when x is {
    ...<10 then 1,
    _ then 0,
  }
}

let test_multiple_ranges() Int = {
  let x = 50
  when x is {
    0..9 then 1,
    10..49 then 2,
    50..99 then 3,
    _ then 0,
  }
}

let test_boundary() Int = {
  // Test boundary values
  let x = 5
  when x is {
    0..10 then 1,
    _ then 0,
  }
}

// Test negative number patterns
let test_negative_range() Int = {
  let x = 0 - 5  // x = -5
  when x is {
    -10..0 then 1,
    _ then 0,
  }
}

let test_negative_to_positive() Int = {
  let x = 0
  when x is {
    -5..5 then 1,
    _ then 0,
  }
}

let test_negative_from_range() Int = {
  let x = 0 - 100  // x = -100
  when x is {
    ...-50 then 1,  // x <= -50
    _ then 0,
  }
}

let test_negative_boundary() Int = {
  let x = 0 - 10  // x = -10
  when x is {
    -10..10 then 1,
    _ then 0,
  }
}

let main() Int = {
  // Test closed range: 5 is in 1..10
  if test_closed_range() <> 1 then {
    print_line("FAIL: test_closed_range")
    return 1
  }
  
  // Test closed-open range: 10 is NOT in 1..<10
  if test_closed_open_range() <> 0 then {
    print_line("FAIL: test_closed_open_range")
    return 1
  }
  
  // Test open-closed range: 1 is NOT in 1<..10
  if test_open_closed_range() <> 0 then {
    print_line("FAIL: test_open_closed_range")
    return 1
  }
  
  // Test open range: 5 is in 1<..<10
  if test_open_range() <> 1 then {
    print_line("FAIL: test_open_range")
    return 1
  }
  
  // Test from range: 100 is in 10...
  if test_from_range() <> 1 then {
    print_line("FAIL: test_from_range")
    return 1
  }
  
  // Test to range: 5 is in ...10
  if test_to_range() <> 1 then {
    print_line("FAIL: test_to_range")
    return 1
  }
  
  // Test to-open range: 10 is NOT in ...<10
  if test_to_open_range() <> 0 then {
    print_line("FAIL: test_to_open_range")
    return 1
  }
  
  // Test multiple ranges: 50 is in 50..99
  if test_multiple_ranges() <> 3 then {
    print_line("FAIL: test_multiple_ranges")
    return 1
  }
  
  // Test boundary: 5 is in 0..10
  if test_boundary() <> 1 then {
    print_line("FAIL: test_boundary")
    return 1
  }
  
  // Test negative range: -5 is in -10..0
  if test_negative_range() <> 1 then {
    print_line("FAIL: test_negative_range")
    return 1
  }
  
  // Test negative to positive: 0 is in -5..5
  if test_negative_to_positive() <> 1 then {
    print_line("FAIL: test_negative_to_positive")
    return 1
  }
  
  // Test negative from range: -100 is in ...-50
  if test_negative_from_range() <> 1 then {
    print_line("FAIL: test_negative_from_range")
    return 1
  }
  
  // Test negative boundary: -10 is in -10..10
  if test_negative_boundary() <> 1 then {
    print_line("FAIL: test_negative_boundary")
    return 1
  }
  
  print_line("All range pattern tests passed!")
  0
}

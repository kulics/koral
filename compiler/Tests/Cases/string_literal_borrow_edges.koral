// EXPECT: empty_literal_capacity_ok
// EXPECT: empty_literal_cow_ok
// EXPECT: many_pattern_literals_ok

let test_empty_literal_capacity_and_cow() Void = {
    let empty = ""
    assert(empty.count() == 0, "empty literal count")
    assert(empty.capacity() == 0, "empty literal capacity should be 0")
    println("empty_literal_capacity_ok")

    let mut copy = empty
    let bang UInt8 = 33
    copy.push(bang)
    assert(empty == "", "source empty literal should remain unchanged")
    assert(copy == "!", "copied empty literal should be mutable after COW")
    println("empty_literal_cow_ok")
}

let test_many_pattern_literals() Void = {
    let key = "k9"
    let value = when key in {
        "k0" then 0,
        "k1" then 1,
        "k2" then 2,
        "k3" then 3,
        "k4" then 4,
        "k5" then 5,
        "k6" then 6,
        "k7" then 7,
        "k8" then 8,
        "k9" then 9,
        _ then 100,
    }
    assert(value == 9, "many string literal branches should match correctly")
    println("many_pattern_literals_ok")
}

let main() Void = {
    test_empty_literal_capacity_and_cow()
    test_many_pattern_literals()
}

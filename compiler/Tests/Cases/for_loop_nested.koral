// Test nested for loops - verify iterator variables don't conflict

// EXPECT: Nested loop test:
// EXPECT: (1,a)
// EXPECT: (1,b)
// EXPECT: (2,a)
// EXPECT: (2,b)
// EXPECT: (3,a)
// EXPECT: (3,b)
// EXPECT: Triple nested sum: 2004
// EXPECT: All nested for loop tests passed

let main() Void = {
    // Test 1: Double nested for loop
    println("Nested loop test:")
    let mut nums = [Int]List.new()
    nums.push(1)
    nums.push(2)
    nums.push(3)
    
    let mut chars = [String]List.new()
    chars.push("a")
    chars.push("b")
    
    for n in nums then {
        for c in chars then {
            print("(")
            print(n)
            print(",")
            print(c)
            println(")")
        }
    }
    
    // Test 2: Triple nested for loop
    let mut a = [Int]List.new()
    a.push(1)
    a.push(2)
    a.push(3)
    
    let mut b = [Int]List.new()
    b.push(10)
    b.push(20)
    
    let mut c = [Int]List.new()
    c.push(100)
    c.push(200)
    
    let mut sum = 0
    for x in a then {
        for y in b then {
            for z in c then {
                sum = sum + x + y + z
            }
        }
    }
    
    // Expected: 3 * 2 * 2 = 12 iterations
    // Each iteration adds: (1+10+100), (1+10+200), (1+20+100), (1+20+200),
    //                      (2+10+100), (2+10+200), (2+20+100), (2+20+200),
    //                      (3+10+100), (3+10+200), (3+20+100), (3+20+200)
    // = 111+211+121+221 + 112+212+122+222 + 113+213+123+223
    // = 664 + 668 + 672 = 2004
    // Actually: sum of x = 1+1+1+1+2+2+2+2+3+3+3+3 = 24
    //           sum of y = (10+10+20+20)*3 = 180
    //           sum of z = (100+200)*6 = 1800
    //           total = 24 + 180 + 1800 = 2004? No wait...
    // Let me recalculate: 12 iterations, each adds x+y+z
    // x contributes: 1*4 + 2*4 + 3*4 = 24
    // y contributes: 10*6 + 20*6 = 180  
    // z contributes: 100*6 + 200*6 = 1800
    // Total = 24 + 180 + 1800 = 2004? Hmm let me verify differently
    // Actually for each x (3 values), we iterate y (2 values) * z (2 values) = 4 times
    // So x contributes: (1+2+3) * 4 = 24
    // For each y (2 values), we iterate x (3 values) * z (2 values) = 6 times
    // So y contributes: (10+20) * 6 = 180
    // For each z (2 values), we iterate x (3 values) * y (2 values) = 6 times
    // So z contributes: (100+200) * 6 = 1800
    // Total = 24 + 180 + 1800 = 2004
    // Hmm the comment says 216, let me use smaller numbers
    
    print("Triple nested sum: ")
    println(sum)
    assert(sum == 2004, "triple nested sum")
    
    println("All nested for loop tests passed")
}

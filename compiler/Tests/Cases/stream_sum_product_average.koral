// Stream aggregations: sum/product/average
// EXPECT: test_stream_sum_product_average passed

let test_stream_sum_product_average() Void = {
    let mut list = [Int]List.new()
    list.push(1)
    list.push(2)
    list.push(3)
    list.push(4)
    list.push(5)

    let s = stream(list).sum()
    if s <> 15 then { panic("sum failed"); }

    let p = stream(list).product()
    if p <> 120 then { panic("product failed"); }

    when stream(list).average() is {
        .Some(avg) then {
            // integer division for Int
            if avg <> 3 then { panic("average failed"); }
        },
        .None then { panic("average returned None"); },
    }

    let mut empty = [Int]List.new()
    when stream(empty).average() is {
        .None then {},
        .Some(_) then { panic("empty average should be None"); },
    }

    print_line("test_stream_sum_product_average passed")
}

let main() Void = {
    test_stream_sum_product_average()
}

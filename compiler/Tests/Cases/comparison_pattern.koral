// Test comparison patterns in when expressions
// EXPECT: test_greater: PASS
// EXPECT: test_less: PASS
// EXPECT: test_greater_equal: PASS
// EXPECT: test_less_equal: PASS
// EXPECT: test_negative_comparison: PASS
// EXPECT: test_boundary_values: PASS
// EXPECT: test_multiple_comparisons: PASS
// EXPECT: All comparison pattern tests passed!

// Test > pattern
let test_greater() Int = {
    let x = 10
    yield when x is {
        > 5 then 1,
        _ then 0,
    }
}

// Test < pattern
let test_less() Int = {
    let x = 3
    yield when x is {
        < 5 then 1,
        _ then 0,
    }
}

// Test >= pattern
let test_greater_equal() Int = {
    let x = 5
    yield when x is {
        >= 5 then 1,
        _ then 0,
    }
}

// Test <= pattern
let test_less_equal() Int = {
    let x = 5
    yield when x is {
        <= 5 then 1,
        _ then 0,
    }
}

// Test comparison with negative literals
let test_negative_comparison() Int = {
    let x = 0 - 3  // x = -3
    yield when x is {
        > -5 then 1,  // -3 > -5 is true
        _ then 0,
    }
}

// Test boundary values
let test_boundary_values() Int = {
    let a = 5
    let b = 5
    let c = 4
    let d = 6
    
    // Test >= 5 with value 5 (should match)
    let r1 = when a is {
        >= 5 then 1,
        _ then 0,
    }
    
    // Test > 5 with value 5 (should NOT match)
    let r2 = when b is {
        > 5 then 0,
        _ then 1,
    }
    
    // Test < 5 with value 4 (should match)
    let r3 = when c is {
        < 5 then 1,
        _ then 0,
    }
    
    // Test <= 5 with value 6 (should NOT match)
    let r4 = when d is {
        <= 5 then 0,
        _ then 1,
    }
    
    yield if r1 == 1 and r2 == 1 and r3 == 1 and r4 == 1 then 1 else 0
}

// Test multiple comparison patterns in one when
let test_multiple_comparisons() Int = {
    let x = 50
    yield when x is {
        < 0 then 1,
        < 10 then 2,
        < 50 then 3,
        >= 50 then 4,
        _ then 0,
    }
}

let main() Int = {
    // Test > pattern
    if test_greater() == 1 then {
        println("test_greater: PASS")
    } else {
        println("test_greater: FAIL")
        return 1
    }
    
    // Test < pattern
    if test_less() == 1 then {
        println("test_less: PASS")
    } else {
        println("test_less: FAIL")
        return 1
    }
    
    // Test >= pattern
    if test_greater_equal() == 1 then {
        println("test_greater_equal: PASS")
    } else {
        println("test_greater_equal: FAIL")
        return 1
    }
    
    // Test <= pattern
    if test_less_equal() == 1 then {
        println("test_less_equal: PASS")
    } else {
        println("test_less_equal: FAIL")
        return 1
    }
    
    // Test negative comparison
    if test_negative_comparison() == 1 then {
        println("test_negative_comparison: PASS")
    } else {
        println("test_negative_comparison: FAIL")
        return 1
    }
    
    // Test boundary values
    if test_boundary_values() == 1 then {
        println("test_boundary_values: PASS")
    } else {
        println("test_boundary_values: FAIL")
        return 1
    }
    
    // Test multiple comparisons
    if test_multiple_comparisons() == 4 then {
        println("test_multiple_comparisons: PASS")
    } else {
        println("test_multiple_comparisons: FAIL")
        return 1
    }
    
    println("All comparison pattern tests passed!")
    yield 0
}

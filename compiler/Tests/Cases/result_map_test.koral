// Test Result.map and Result.map_error generic methods
// EXPECT: 84
// EXPECT: Error preserved
// EXPECT: Ok preserved
// EXPECT: ERROR_42

let main() Int = {
    // Test map on Ok
    let ok_result = [Int, String]Result.Ok(42)
    let doubled = ok_result.[Int]map((x) -> x * 2)
    
    when doubled is {
        .Ok(v) then print_line(v.to_string()),
        .Error(e) then print_line(e),
    }
    
    // Test map on Error
    let err_result = [Int, String]Result.Error("Error preserved")
    let mapped_err = err_result.[Int]map((x) -> x * 2)
    
    when mapped_err is {
        .Ok(v) then print_line(v.to_string()),
        .Error(e) then print_line(e),
    }
    
    // Test map_error on Ok
    let ok_result2 = [Int, String]Result.Ok(100)
    let mapped_ok = ok_result2.[String]map_error((e) -> {
        let mut s = "MAPPED: "
        s.push_string(e)
        s
    })
    
    when mapped_ok is {
        .Ok(v) then print_line("Ok preserved"),
        .Error(e) then print_line(e),
    }
    
    // Test map_error on Error
    let err_result2 = [Int, Int]Result.Error(42)
    let mapped_err2 = err_result2.[String]map_error((e) -> {
        let mut s = "ERROR_"
        s.push_int(e)
        s
    })
    
    when mapped_err2 is {
        .Ok(v) then print_line(v.to_string()),
        .Error(e) then print_line(e),
    }
    
    0
}
